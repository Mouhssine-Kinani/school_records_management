{% extends 'base.html.twig' %}

{% block title %}Détails Enseignant - Système Scolaire{% endblock %}

{% block body %}
<div class="flex h-screen w-full overflow-hidden">
    <!-- Sidebar -->
    {% include 'components/_sidebar.html.twig' %}

    <div class="flex-1 flex flex-col min-w-0 bg-background-light dark:bg-background-dark overflow-hidden">
        <!-- Navbar -->
        {% include 'components/_navbar.html.twig' %}

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto w-full">
            <div class="max-w-7xl mx-auto px-6 py-8 flex flex-col gap-8">
                
                <!-- Hero Section: Teacher Profile Header -->
                <section class="bg-white dark:bg-surface-dark rounded-3xl p-6 md:p-8 flex flex-col md:flex-row items-start md:items-center justify-between gap-6 relative overflow-hidden group border border-slate-200 dark:border-[#29382f]">
                    <!-- Decorative blurred background element -->
                    <div class="absolute top-0 right-0 -mt-20 -mr-20 size-64 bg-primary/5 rounded-full blur-3xl pointer-events-none group-hover:bg-primary/10 transition-colors"></div>
                    
                    <div class="flex flex-col sm:flex-row items-center sm:items-start md:items-center gap-6 z-10">
                        <div class="relative">
                            <div class="size-32 rounded-full border-4 border-slate-200 dark:border-[#253029] bg-primary text-background-dark font-bold text-4xl flex items-center justify-center shadow-xl">
                                {{ teacher.prenom|first|upper }}{{ teacher.nom|first|upper }}
                            </div>
                            <div class="absolute bottom-2 right-2 size-5 bg-primary rounded-full border-4 border-white dark:border-surface-dark shadow-sm" title="Actif"></div>
                        </div>
                        <div class="text-center sm:text-left">
                            <h2 class="text-3xl font-bold text-slate-900 dark:text-white mb-1">
                                {{ teacher.nom }}, {{ teacher.prenom }}
                            </h2>
                            <p class="text-primary font-medium text-lg mb-2">
                                {% if teacher.specialite %}
                                    Enseignant de {{ teacher.specialite }}
                                {% else %}
                                    Enseignant
                                {% endif %}
                            </p>
                            <div class="flex flex-wrap justify-center sm:justify-start gap-3">
                                <span class="px-3 py-1 rounded-full bg-slate-100 dark:bg-surface-dark border border-slate-200 dark:border-[#29382f] text-xs text-slate-600 dark:text-[#9eb7a8] font-medium">
                                    ID: #T-{{ "now"|date("Y") }}-{{ teacher.id|format('%03d') }}
                                </span>
                                <span class="px-3 py-1 rounded-full bg-slate-100 dark:bg-surface-dark border border-slate-200 dark:border-[#29382f] text-xs text-slate-600 dark:text-[#9eb7a8] font-medium">
                                    {{ classes|length }} classes assignées
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row w-full md:w-auto gap-3 z-10">
                        <button class="flex-1 sm:flex-none h-11 px-6 rounded-full bg-primary text-background-dark font-bold text-sm hover:bg-[#2bc766] transition-colors flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined text-[20px]">edit</span>
                            <span>Modifier</span>
                        </button>
                        <a href="{{ path('admin_enseignants') }}" class="flex-1 sm:flex-none h-11 px-6 rounded-full bg-slate-100 dark:bg-surface-dark text-slate-900 dark:text-white font-medium text-sm hover:bg-slate-200 dark:hover:bg-[#35453c] border border-slate-200 dark:border-[#29382f] transition-colors flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined text-[20px]">arrow_back</span>
                            <span>Retour</span>
                        </a>
                    </div>
                </section>

                <!-- Grid Layout -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                    <!-- Left Column: Personal Info (4 cols) -->
                    <div class="lg:col-span-4 flex flex-col gap-6">
                        <!-- Info Card -->
                        <div class="bg-white dark:bg-surface-dark rounded-3xl p-6 border border-slate-200 dark:border-[#29382f]">
                            <div class="flex items-center gap-2 mb-6">
                                <span class="material-symbols-outlined text-primary">person</span>
                                <h3 class="text-lg font-bold text-slate-900 dark:text-white">Info Personnelles</h3>
                            </div>
                            <div class="flex flex-col gap-5">
                                <div class="group">
                                    <p class="text-xs font-medium text-slate-500 dark:text-[#9eb7a8] uppercase tracking-wider mb-1">Email</p>
                                    <div class="flex items-center justify-between">
                                        <p class="text-slate-900 dark:text-white text-sm font-medium">{{ teacher.email }}</p>
                                        <button class="opacity-0 group-hover:opacity-100 text-slate-500 dark:text-[#9eb7a8] hover:text-primary transition-opacity">
                                            <span class="material-symbols-outlined text-[18px]">content_copy</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="h-px bg-slate-200 dark:bg-[#29382f]"></div>
                                <div>
                                    <p class="text-xs font-medium text-slate-500 dark:text-[#9eb7a8] uppercase tracking-wider mb-1">Téléphone</p>
                                    <p class="text-slate-900 dark:text-white text-sm font-medium">
                                        {% if teacher.telephone %}
                                            {{ teacher.telephone }}
                                        {% else %}
                                            <span class="text-slate-400 dark:text-[#9eb7a8]/50 italic">Non renseigné</span>
                                        {% endif %}
                                    </p>
                                </div>
                                <div class="h-px bg-slate-200 dark:bg-[#29382f]"></div>
                                <div>
                                    <p class="text-xs font-medium text-slate-500 dark:text-[#9eb7a8] uppercase tracking-wider mb-1">Date d'inscription</p>
                                    <p class="text-slate-900 dark:text-white text-sm font-medium">
                                        {{ teacher.dateCreation|date('d F Y') }}
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Subjects / Competencies -->
                        <div class="bg-white dark:bg-surface-dark rounded-3xl p-6 border border-slate-200 dark:border-[#29382f]">
                            <div class="flex items-center gap-2 mb-4">
                                <span class="material-symbols-outlined text-primary">school</span>
                                <h3 class="text-lg font-bold text-slate-900 dark:text-white">Matières Enseignées</h3>
                            </div>
                            <div class="flex flex-wrap gap-2">
                                {% set uniqueSubjects = [] %}
                                {% for classData in classes %}
                                    {% if classData.matiere.nom not in uniqueSubjects %}
                                        {% set uniqueSubjects = uniqueSubjects|merge([classData.matiere.nom]) %}
                                        <span class="px-4 py-2 rounded-full bg-slate-100 dark:bg-surface-dark text-slate-900 dark:text-white text-sm font-medium border border-slate-200 dark:border-[#29382f] hover:border-primary/50 transition-colors cursor-default">
                                            {{ classData.matiere.nom }}
                                        </span>
                                    {% endif %}
                                {% endfor %}
                                
                                {% if uniqueSubjects|length == 0 %}
                                    <p class="text-slate-400 dark:text-[#9eb7a8]/50 text-sm italic">Aucune matière assignée</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Classes (8 cols) -->
                    <div class="lg:col-span-8 flex flex-col gap-6">
                        <!-- Assigned Classes Grid -->
                        <div>
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
                                    <span class="material-symbols-outlined text-primary">class</span>
                                    Classes Assignées
                                </h3>
                            </div>
                            
                            {% if classes|length > 0 %}
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {% for classData in classes %}
                                    <!-- Class Card -->
                                    <div class="bg-white dark:bg-surface-dark hover:bg-slate-50 dark:hover:bg-[#202b25] transition-colors rounded-3xl p-5 border border-slate-200 dark:border-[#29382f] group relative overflow-hidden">
                                        <div class="absolute top-0 right-0 w-24 h-24 bg-gradient-to-bl from-primary/10 to-transparent rounded-bl-full pointer-events-none"></div>
                                        
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="size-12 rounded-2xl bg-slate-100 dark:bg-surface-dark flex items-center justify-center text-slate-900 dark:text-white border border-slate-200 dark:border-[#29382f]">
                                                <span class="material-symbols-outlined">functions</span>
                                            </div>
                                            <span class="px-3 py-1 rounded-full bg-primary/20 text-primary text-xs font-bold">
                                                {{ classData.anneeScolaire }}
                                            </span>
                                        </div>
                                        
                                        <h4 class="text-lg font-bold text-slate-900 dark:text-white">
                                            {{ classData.classe.nom }}
                                        </h4>
                                        <p class="text-slate-500 dark:text-[#9eb7a8] text-sm mb-4">
                                            {{ classData.matiere.nom }} • Niveau {{ classData.classe.niveau }}
                                        </p>
                                        
                                        <div class="flex items-center justify-between mt-auto">
                                            <span class="text-sm font-medium text-slate-900 dark:text-white">
                                                {{ classData.studentCount }} Élève{{ classData.studentCount > 1 ? 's' : '' }}
                                            </span>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="bg-white dark:bg-surface-dark rounded-3xl p-8 border border-slate-200 dark:border-[#29382f] text-center">
                                    <div class="flex flex-col items-center gap-3 text-slate-400 dark:text-[#9eb7a8]/50">
                                        <span class="material-symbols-outlined text-5xl">class</span>
                                        <p class="text-sm">Aucune classe assignée pour cet enseignant</p>
                                    </div>
                                </div>
                            {% endif %}
                        </div>

                        <!-- Activity Log Placeholder -->
                        <div class="bg-white dark:bg-surface-dark rounded-3xl p-6 border border-slate-200 dark:border-[#29382f]">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2">
                                    <span class="material-symbols-outlined text-primary">history</span>
                                    Activité Récente
                                </h3>
                            </div>
                            <div class="flex flex-col items-center gap-3 py-8 text-slate-400 dark:text-[#9eb7a8]/50">
                                <span class="material-symbols-outlined text-5xl">event_busy</span>
                                <p class="text-sm">Le suivi des activités sera disponible prochainement</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}
